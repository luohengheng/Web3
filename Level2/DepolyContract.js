import { ethers } from "ethers";

// const ALCHEMOLY_KEY = 'UmH8ksPbAVGoXlELP86ZIq1tzx_Y3zrr'
// const provider = new ethers.JsonRpcProvider(`https://eth-sepolia.g.alchemy.com/v2/${ALCHEMOLY_KEY}`)
const provider = new ethers.JsonRpcProvider('http://127.0.0.1:7545')
const PRIVEATE_KEY = '0x6c65bf7e07bee0058a3d58275bef9e77a2cd759df129b1126a50abade6b275ef'
const wallet = new ethers.Wallet(PRIVEATE_KEY, provider)
const walletAddress = await wallet.address

const abiArr = [
    "constructor(uint256 initialSupply)",
    "function mint(address to, uint256 amount)",
    "function burn(uint256 amount)"
]
const bytecode = "608060405234801561000f575f80fd5b50604051611b4d380380611b4d833981810160405281019061003191906104ee565b336040518060400160405280600881526020017f4d79546f6b656e330000000000000000000000000000000000000000000000008152506040518060400160405280600481526020017f4d544b330000000000000000000000000000000000000000000000000000000081525081600390816100ad919061074a565b5080600490816100bd919061074a565b5050505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610130575f6040517f1e4fbdf70000000000000000000000000000000000000000000000000000000081526004016101279190610858565b60405180910390fd5b61013f8161015660201b60201c565b50610150338261021960201b60201c565b5061092e565b5f60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508160055f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610289575f6040517fec442f050000000000000000000000000000000000000000000000000000000081526004016102809190610858565b60405180910390fd5b61029a5f838361029e60201b60201c565b5050565b5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16036102ee578060025f8282546102e2919061089e565b925050819055506103bc565b5f805f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054905081811015610377578381836040517fe450d38c00000000000000000000000000000000000000000000000000000000815260040161036e939291906108e0565b60405180910390fd5b8181035f808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2081905550505b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610403578060025f828254039250508190555061044d565b805f808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825401925050819055505b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef836040516104aa9190610915565b60405180910390a3505050565b5f80fd5b5f819050919050565b6104cd816104bb565b81146104d7575f80fd5b50565b5f815190506104e8816104c4565b92915050565b5f60208284031215610503576105026104b7565b5b5f610510848285016104da565b91505092915050565b5f81519050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f600282049050600182168061059457607f821691505b6020821081036105a7576105a6610550565b5b50919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026106097fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff826105ce565b61061386836105ce565b95508019841693508086168417925050509392505050565b5f819050919050565b5f61064e610649610644846104bb565b61062b565b6104bb565b9050919050565b5f819050919050565b61066783610634565b61067b61067382610655565b8484546105da565b825550505050565b5f90565b61068f610683565b61069a81848461065e565b505050565b5b818110156106bd576106b25f82610687565b6001810190506106a0565b5050565b601f821115610702576106d3816105ad565b6106dc846105bf565b810160208510156106eb578190505b6106ff6106f7856105bf565b83018261069f565b50505b505050565b5f82821c905092915050565b5f6107225f1984600802610707565b1980831691505092915050565b5f61073a8383610713565b9150826002028217905092915050565b61075382610519565b67ffffffffffffffff81111561076c5761076b610523565b5b610776825461057d565b6107818282856106c1565b5f60209050601f8311600181146107b2575f84156107a0578287015190505b6107aa858261072f565b865550610811565b601f1984166107c0866105ad565b5f5b828110156107e7578489015182556001820191506020850194506020810190506107c2565b868310156108045784890151610800601f891682610713565b8355505b6001600288020188555050505b505050505050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61084282610819565b9050919050565b61085281610838565b82525050565b5f60208201905061086b5f830184610849565b92915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f6108a8826104bb565b91506108b3836104bb565b92508282019050808211156108cb576108ca610871565b5b92915050565b6108da816104bb565b82525050565b5f6060820190506108f35f830186610849565b61090060208301856108d1565b61090d60408301846108d1565b949350505050565b5f6020820190506109285f8301846108d1565b92915050565b6112128061093b5f395ff3fe608060405234801561000f575f80fd5b50600436106100e8575f3560e01c806370a082311161008a57806395d89b411161006457806395d89b4114610236578063a9059cbb14610254578063dd62ed3e14610284578063f2fde38b146102b4576100e8565b806370a08231146101de578063715018a61461020e5780638da5cb5b14610218576100e8565b806323b872dd116100c657806323b872dd14610158578063313ce5671461018857806340c10f19146101a657806342966c68146101c2576100e8565b806306fdde03146100ec578063095ea7b31461010a57806318160ddd1461013a575b5f80fd5b6100f46102d0565b6040516101019190610e60565b60405180910390f35b610124600480360381019061011f9190610f11565b610360565b6040516101319190610f69565b60405180910390f35b610142610382565b60405161014f9190610f91565b60405180910390f35b610172600480360381019061016d9190610faa565b61038b565b60405161017f9190610f69565b60405180910390f35b6101906103b9565b60405161019d9190611015565b60405180910390f35b6101c060048036038101906101bb9190610f11565b6103c1565b005b6101dc60048036038101906101d7919061102e565b6103d7565b005b6101f860048036038101906101f39190611059565b6103ec565b6040516102059190610f91565b60405180910390f35b610216610431565b005b610220610444565b60405161022d9190611093565b60405180910390f35b61023e61046c565b60405161024b9190610e60565b60405180910390f35b61026e60048036038101906102699190610f11565b6104fc565b60405161027b9190610f69565b60405180910390f35b61029e600480360381019061029991906110ac565b61051e565b6040516102ab9190610f91565b60405180910390f35b6102ce60048036038101906102c99190611059565b6105a0565b005b6060600380546102df90611117565b80601f016020809104026020016040519081016040528092919081815260200182805461030b90611117565b80156103565780601f1061032d57610100808354040283529160200191610356565b820191905f5260205f20905b81548152906001019060200180831161033957829003601f168201915b5050505050905090565b5f8061036a610624565b905061037781858561062b565b600191505092915050565b5f600254905090565b5f80610395610624565b90506103a285828561063d565b6103ad8585856106d0565b60019150509392505050565b5f6012905090565b6103c96107c0565b6103d38282610847565b5050565b6103df6107c0565b6103e933826108c6565b50565b5f805f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20549050919050565b6104396107c0565b6104425f610945565b565b5f60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60606004805461047b90611117565b80601f01602080910402602001604051908101604052809291908181526020018280546104a790611117565b80156104f25780601f106104c9576101008083540402835291602001916104f2565b820191905f5260205f20905b8154815290600101906020018083116104d557829003601f168201915b5050505050905090565b5f80610506610624565b90506105138185856106d0565b600191505092915050565b5f60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054905092915050565b6105a86107c0565b5f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610618575f6040517f1e4fbdf700000000000000000000000000000000000000000000000000000000815260040161060f9190611093565b60405180910390fd5b61062181610945565b50565b5f33905090565b6106388383836001610a08565b505050565b5f610648848461051e565b90507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8110156106ca57818110156106bb578281836040517ffb8f41b20000000000000000000000000000000000000000000000000000000081526004016106b293929190611147565b60405180910390fd5b6106c984848484035f610a08565b5b50505050565b5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603610740575f6040517f96c6fd1e0000000000000000000000000000000000000000000000000000000081526004016107379190611093565b60405180910390fd5b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16036107b0575f6040517fec442f050000000000000000000000000000000000000000000000000000000081526004016107a79190611093565b60405180910390fd5b6107bb838383610bd7565b505050565b6107c8610624565b73ffffffffffffffffffffffffffffffffffffffff166107e6610444565b73ffffffffffffffffffffffffffffffffffffffff161461084557610809610624565b6040517f118cdaa700000000000000000000000000000000000000000000000000000000815260040161083c9190611093565b60405180910390fd5b565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16036108b7575f6040517fec442f050000000000000000000000000000000000000000000000000000000081526004016108ae9190611093565b60405180910390fd5b6108c25f8383610bd7565b5050565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610936575f6040517f96c6fd1e00000000000000000000000000000000000000000000000000000000815260040161092d9190611093565b60405180910390fd5b610941825f83610bd7565b5050565b5f60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508160055f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f73ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff1603610a78575f6040517fe602df05000000000000000000000000000000000000000000000000000000008152600401610a6f9190611093565b60405180910390fd5b5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603610ae8575f6040517f94280d62000000000000000000000000000000000000000000000000000000008152600401610adf9190611093565b60405180910390fd5b8160015f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055508015610bd1578273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92584604051610bc89190610f91565b60405180910390a35b50505050565b5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603610c27578060025f828254610c1b91906111a9565b92505081905550610cf5565b5f805f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054905081811015610cb0578381836040517fe450d38c000000000000000000000000000000000000000000000000000000008152600401610ca793929190611147565b60405180910390fd5b8181035f808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2081905550505b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610d3c578060025f8282540392505081905550610d86565b805f808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825401925050819055505b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef83604051610de39190610f91565b60405180910390a3505050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f610e3282610df0565b610e3c8185610dfa565b9350610e4c818560208601610e0a565b610e5581610e18565b840191505092915050565b5f6020820190508181035f830152610e788184610e28565b905092915050565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610ead82610e84565b9050919050565b610ebd81610ea3565b8114610ec7575f80fd5b50565b5f81359050610ed881610eb4565b92915050565b5f819050919050565b610ef081610ede565b8114610efa575f80fd5b50565b5f81359050610f0b81610ee7565b92915050565b5f8060408385031215610f2757610f26610e80565b5b5f610f3485828601610eca565b9250506020610f4585828601610efd565b9150509250929050565b5f8115159050919050565b610f6381610f4f565b82525050565b5f602082019050610f7c5f830184610f5a565b92915050565b610f8b81610ede565b82525050565b5f602082019050610fa45f830184610f82565b92915050565b5f805f60608486031215610fc157610fc0610e80565b5b5f610fce86828701610eca565b9350506020610fdf86828701610eca565b9250506040610ff086828701610efd565b9150509250925092565b5f60ff82169050919050565b61100f81610ffa565b82525050565b5f6020820190506110285f830184611006565b92915050565b5f6020828403121561104357611042610e80565b5b5f61105084828501610efd565b91505092915050565b5f6020828403121561106e5761106d610e80565b5b5f61107b84828501610eca565b91505092915050565b61108d81610ea3565b82525050565b5f6020820190506110a65f830184611084565b92915050565b5f80604083850312156110c2576110c1610e80565b5b5f6110cf85828601610eca565b92505060206110e085828601610eca565b9150509250929050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f600282049050600182168061112e57607f821691505b602082108103611141576111406110ea565b5b50919050565b5f60608201905061115a5f830186611084565b6111676020830185610f82565b6111746040830184610f82565b949350505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f6111b382610ede565b91506111be83610ede565b92508282019050808211156111d6576111d561117c565b5b9291505056fea264697066735822122044c985124f10e0f3ee0c64e154fcaf265273583da54ab62072821826a91c68d064736f6c634300081a0033"

const contractFac = new ethers.ContractFactory(abiArr, bytecode, wallet)

const myTokenContract = await contractFac.deploy(10000)
console.log(`合约地址: ${myTokenContract.target}`);
console.log("部署合约的交易详情")
console.log(myTokenContract.deploymentTransaction())
console.log("\n等待合约部署上链")
await myTokenContract.waitForDeployment()
// 也可以用 contractERC20.deployTransaction.wait()
console.log("合约已上链")

console.log("\n2. 调用mint()函数，给自己地址mint 10代币")
console.log(`合约名称: ${await myTokenContract.name()}`)
console.log(`合约代号: ${await myTokenContract.symbol()}`)
const tx = await myTokenContract.mint(walletAddress, "10")
await tx.wait()
console.log(`Vitalik钱包中的代币余额:  ${await myTokenContract.balanceOf(ALCHEMOLY_KEY)}`);
